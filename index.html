<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸŒ± ìƒí™œìŠµê´€ íƒ„ì†Œë°œìêµ­ ì‹œë®¬ë ˆì´í„°</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    font-family: "Pretendard", system-ui, sans-serif;
    background: linear-gradient(180deg, #e6f7f1, #f5fefc);
    color: #222;
    margin: 0;
    padding: 0;
  }
  header {
    text-align: center;
    padding: 20px 10px;
    background: #d4f1e3;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  }
  header h1 {
    margin: 0;
    font-size: 22px;
  }
  header p {
    margin: 5px 0 0;
    font-size: 14px;
    color: #444;
  }

  /* âœ… í™”ë©´ì„ ì •í™•íˆ ì ˆë°˜ìœ¼ë¡œ */
  .wrap {
    display: flex;
    justify-content: space-between;
    align-items: stretch;
    height: calc(100vh - 100px);
    padding: 20px;
    gap: 20px;
  }

  .panel {
    flex: 1; /* ì¢Œìš°ê°€ ë™ì¼í•œ ë¹„ìœ¨ */
    background: white;
    border-radius: 16px;
    padding: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }

  .row {
    margin-bottom: 12px;
  }

  label {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
  }

  input[type="range"] {
    width: 100%;
  }

  .grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
  }

  .meter {
    text-align: center;
    padding: 14px;
    border-radius: 12px;
    background: #f0faf6;
    border: 1px solid #d1efe0;
  }

  .meter .val {
    font-size: 28px;
    font-weight: 700;
    color: #19734b;
  }

  .meter .unit {
    font-size: 12px;
    color: #666;
  }

  canvas {
    width: 100% !important;
    height: 320px !important;
  }

  @media (max-width: 900px) {
    .wrap {
      flex-direction: column;
      height: auto;
    }
  }
</style>
</head>
<body>
<header>
  <h1>ğŸŒ ìƒí™œìŠµê´€ë³„ íƒ„ì†Œë°œìêµ­ ì‹œë®¬ë ˆì´í„°</h1>
  <p>10ê°€ì§€ ìƒí™œìŠµê´€ì„ ì¡°ì •í•˜ë©° ì—°ê°„ COâ‚‚ ë°°ì¶œëŸ‰ ë³€í™”ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•˜ì„¸ìš”.</p>
</header>

<div class="wrap">
  <!-- ì¢Œ: ìƒí™œìŠµê´€ ì¡°ì • -->
  <section class="panel">
    <h2 style="margin-top:0;font-size:18px;">â‘  ìƒí™œìŠµê´€ ì¡°ì •</h2>
    <div id="sliders"></div>
  </section>

  <!-- ìš°: ê²°ê³¼ -->
  <section class="panel">
    <h2 style="margin-top:0;font-size:18px;">â‘¡ ê²°ê³¼</h2>
    <div class="grid-2">
      <div class="meter">
        <div class="val" id="totalCO2">0.0</div>
        <div class="unit">í†¤ COâ‚‚ / ë…„</div>
      </div>
      <div class="meter">
        <div class="val" id="earths">1.0</div>
        <div class="unit">ğŸŒ ì§€êµ¬ ì‚¬ìš© ê°œìˆ˜ (1=ì§€ì†ê°€ëŠ¥)</div>
      </div>
    </div>
    <canvas id="chart" style="margin-top:20px;"></canvas>
  </section>
</div>

<script>
// ===============================
// ë³€ìˆ˜ ì„¤ì •
// ===============================
const activities = [
  { key: "transport", label: "êµí†µìˆ˜ë‹¨ ì´ìš© (ìë™ì°¨ ì¤‘ì‹¬ â†” ëŒ€ì¤‘êµí†µ ì¤‘ì‹¬)", coef: 1.8 },
  { key: "electricity", label: "ì „ê¸° ì‚¬ìš©ëŸ‰ (ì ìŒ â†” ë§ìŒ)", coef: 1.4 },
  { key: "heating", label: "ë‚œë°©/ëƒ‰ë°© ì‚¬ìš© (ì ˆì•½ â†” ê³¼ë‹¤)", coef: 1.2 },
  { key: "diet", label: "ì‹ìŠµê´€ (ì±„ì‹ â†” ìœ¡ì‹ ìœ„ì£¼)", coef: 1.5 },
  { key: "consumption", label: "ì†Œë¹„ìŠµê´€ (ì ˆì•½ â†” ê³¼ì†Œë¹„)", coef: 1.0 },
  { key: "recycle", label: "ì¬í™œìš©ë¥  (ë‚®ìŒ â†” ë†’ìŒ)", coef: -1.0 },
  { key: "travel", label: "ì—¬í–‰ ë¹ˆë„ (ì ìŒ â†” ì¦ìŒ)", coef: 0.8 },
  { key: "water", label: "ë¬¼ ì‚¬ìš© (ì ˆì•½ â†” ë‚­ë¹„)", coef: 0.6 },
  { key: "internet", label: "ì¸í„°ë„· ì‚¬ìš©ì‹œê°„ (ì ìŒ â†” ë§ìŒ)", coef: 0.4 },
  { key: "housing", label: "ì£¼ê±° í˜•íƒœ (ê³µë™ì£¼íƒ â†” ë‹¨ë…ì£¼íƒ)", coef: 0.5 },
];

// ===============================
// ìŠ¬ë¼ì´ë” ìƒì„±
// ===============================
const container = document.getElementById("sliders");
activities.forEach((a) => {
  const div = document.createElement("div");
  div.className = "row";
  div.innerHTML = `
    <label>${a.label}<span id="out_${a.key}">50</span></label>
    <input type="range" id="${a.key}" min="0" max="100" value="50" step="1">
  `;
  container.appendChild(div);
});

// ===============================
// ê³„ì‚° í•¨ìˆ˜
// ===============================
function calcTotal() {
  let total = 0;
  activities.forEach((a) => {
    const v = document.getElementById(a.key).value;
    const factor = (v - 50) / 50;
    const c = a.coef * (1 + factor);
    total += c > 0 ? c : 0;
  });
  return total;
}

// ===============================
// ê²°ê³¼ í‘œì‹œ
// ===============================
const totalEl = document.getElementById("totalCO2");
const earthEl = document.getElementById("earths");
const ctx = document.getElementById("chart").getContext("2d");
let chart = new Chart(ctx, {
  type: "doughnut",
  data: {
    labels: activities.map((a) => a.label.split(" ")[0]),
    datasets: [
      {
        data: Array(activities.length).fill(0),
        backgroundColor: [
          "#72c2a7", "#a3d9a5", "#f2c94c", "#f2994a", "#eb5757",
          "#56ccf2", "#bb6bd9", "#27ae60", "#2d9cdb", "#9b51e0",
        ],
      },
    ],
  },
  options: {
    plugins: {
      legend: { position: "bottom" },
      tooltip: { callbacks: { label: (ctx) => `${ctx.label}: ${ctx.formattedValue}í†¤` } },
    },
    cutout: "65%",
  },
});

function update() {
  const total = calcTotal();
  totalEl.textContent = total.toFixed(1);
  const earths = total / 3; // 1ì§€êµ¬=3í†¤ ê¸°ì¤€
  earthEl.textContent = earths.toFixed(1);
  chart.data.datasets[0].data = activities.map((a) => {
    const v = document.getElementById(a.key).value;
    const factor = (v - 50) / 50;
    const c = a.coef * (1 + factor);
    return c > 0 ? c : 0;
  });
  chart.update();
}

// ===============================
// ì´ë²¤íŠ¸ ë“±ë¡
// ===============================
activities.forEach((a) => {
  const s = document.getElementById(a.key);
  const o = document.getElementById("out_" + a.key);
  s.addEventListener("input", () => {
    o.textContent = s.value;
    update();
  });
});
update();
</script>
</body>
</html>
